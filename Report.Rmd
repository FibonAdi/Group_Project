--
title: "Twitch Streamer Report"
author: "CARLS <br> Craig, Adi, Ronan, Lauren, and Sophia"
institute: "University of Edinburgh"
date: "`r Sys.Date()`"
---

```{r load-packages, include = FALSE}
# Add any additional packages you need to this chunk
library(tidyverse)
library(palmerpenguins)
library(knitr)
library(xaringanthemer)
library(ggplot2)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r load_data}
twitchdata <- read.csv("twitchdata-update.csv")
```

-------

```{r twitchdata}
twitchdata <- mutate(twitchdata,
                     Gain.percent = 100*Followers.gained/(Followers-Followers.gained))
language_data <- count(twitchdata, Language, sort= TRUE)
```

## Plots and Graphs
_Stream Time to Watch Time, filtering out outliers (values that lie outside 98% of data) and considering only english streamers._
```{r StreamTime_WatchTime, echo=FALSE}
twitchdata %>%
  filter(Language == "English") %>%
 filter(Gain.percent < quantile(Gain.percent, 0.75) &
         Gain.percent > quantile(Gain.percent, 0.25)) %>%
  ggplot(mapping = aes(x = log(Stream.time.minutes.), 
                       y = log(Watch.time.Minutes.))) +
                 geom_point() + 
                 labs (title = "Stream Time to Followers Gained",
                       x = "ln Stream Time (min)",
                       y = "ln Watch Time (min)") +
          geom_smooth()
```


_Considering the interquartile range of the percentage of followers gained over the past year. Again using only english streamers_
``` {r WatchTime_Followers, echo = FALSE}
twitchdata %>%
  filter(Language == "English") %>%
  #filter(Watch.time.Minutes. < quantile(Watch.time.Minutes., 0.99) &
   #      Watch.time.Minutes. > quantile(Watch.time.Minutes., 0.01)) %>%
  filter(Gain.percent < quantile(Gain.percent, 0.9) &
         Gain.percent > quantile(Gain.percent, 0.01)) %>%
  ggplot(mapping = aes(x = log(Watch.time.Minutes.), 
                       y = (Followers))) +
                 geom_point() + 
                 labs (title = "Watch Time to Followers",
                       x = "ln Watch Time (min)",
                       y = "Followers") +
        geom_smooth()
```

``` {r StreamTime_Followers, echo = FALSE}
twitchdata %>%
  filter(Language == "English") %>%
  #filter(Watch.time.Minutes. < quantile(Watch.time.Minutes., 0.99) &
   #      Watch.time.Minutes. > quantile(Watch.time.Minutes., 0.01)) %>%
  filter(Gain.percent < quantile(Gain.percent, 0.75) &
         Gain.percent > quantile(Gain.percent, 0.25)) %>%
  ggplot(mapping = aes(x = log(Stream.time.minutes.), 
                       y = (Gain.percent))) +
                 geom_point() + 
                 labs (title = "Stream Time to Followers",
                       x = "ln Watch Time (min)",
                       y = "Followers") +
        geom_smooth()
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.